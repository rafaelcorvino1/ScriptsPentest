import socket
import argparse

def banner_grabbing(ip, port):
    # Cria um objeto de socket
    s = socket.socket()
    # Define um tempo limite
    s.settimeout(5)

    try:
        # Conecta ao servidor
        s.connect((ip, port))
        # Recebe o banner
        banner = s.recv(1024)
        return banner
    except Exception as e:
        print(f"Erro na porta {port}: {str(e)}")
        return None
    finally:
        # Fecha a conexão
        s.close()

def main():
    # Cria um parser de argumentos
    parser = argparse.ArgumentParser()
    parser.add_argument("ip", help="Endereço IP do servidor alvo.")
    parser.add_argument("ports", type=int, nargs='+', help="Lista de números de porta no servidor alvo.")

    # Parseia os argumentos
    args = parser.parse_args()

    # Executa a função de banner grabbing para cada porta
    for port in args.ports:
        banner = banner_grabbing(args.ip, port)
        if banner:
            print(f"Banner na porta {port}: {banner}")
        else:
            print(f"Não foi possível pegar o banner na porta {port}.")

if __name__ == "__main__":
    main()
